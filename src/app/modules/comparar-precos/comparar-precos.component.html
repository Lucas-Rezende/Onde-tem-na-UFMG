<div class="comparison-container">
  <header class="app-header">
    <h1>üçî Comparador de Pre√ßos</h1>
    <p>Compare os pre√ßos entre as lanchonetes e fa√ßa a melhor escolha!</p>
  </header>

  <div class="controls">
    <button (click)="toggleModoVisualizacao()" class="sort-button">
      {{
      modoVisualizacao === "alfabetica"
      ? "Ordenar por Pre√ßo M√©dio"
      : "Ordenar Alfabeticamente"
      }}
    </button>

    <select (change)="destacarItem($event)" class="item-selector">
      <option value="">Selecionar Item para comparar</option>
      @for (item of itens; track item) {
        <option [value]="item.Item">
          {{ item.Item }}
        </option>
      }
    </select>
  </div>

  @if (itens.length && lanchonetes.length) {
    <div class="highlights">
      <div class="highlight-card">
        <h3>Menor Pre√ßo M√©dio</h3>
        @if (lanchoneteMenorMedia) {
          <p>
            üèÜ {{ lanchoneteMenorMedia }}
          </p>
        } @else {
          <p>-</p>
        }
      </div>
      <div class="highlight-card">
        <h3>Melhor Pre√ßo para {{ itemSelecionado }}</h3>
        @if (lanchoneteComMenorPreco && menorPreco) {
          <p>
            üí∞ {{ lanchoneteComMenorPreco }} | R$ {{ menorPreco }}
            @if (menorPreco) {
              <button (click)="irParaItem()" class="view-item-button">
                Ver Item
              </button>
            }
          </p>
        } @else {
          <p>-</p>
        }
      </div>
      <div class="table-wrapper">
        <table class="price-comparison-table">
          <thead>
            <tr>
              <th class="item-header">Item</th>
              @for (lanchonete of lanchonetes; track lanchonete) {
                <th
                  [class.destacado]="isLanchonete(lanchonete.Nome)"
                  >
                  {{ lanchonete.Nome }}
                </th>
              }
              @if (modoVisualizacao === 'precoMedio') {
                <th>Pre√ßo M√©dio</th>
              }
            </tr>
          </thead>
          <tbody>
            @for (item of itens; track item) {
              <tr [id]="getItemId(item)">
                <td class="item-name">{{ item.Item }}</td>
                @for (lanchonete of lanchonetes; track lanchonete) {
                  <td
                    [class.destacado]="isMenorPreco(item, lanchonete.Nome)"
                    >
                    @if (getPreco(item, lanchonete.Nome)) {
                      R$ {{ getPreco(item, lanchonete.Nome) }}
                    } @else {
                      <span class="nao-disponivel">-</span>
                    }
                  </td>
                }
                @if (modoVisualizacao === 'precoMedio') {
                  <td class="average-price">
                    R$ {{ calcularPrecoMedio(item).toFixed(2) }}
                  </td>
                }
              </tr>
            }
          </tbody>
        </table>
      </div>
      <a href="/" class="fab-home" aria-label="Home">üè†</a>
    </div>
  }
